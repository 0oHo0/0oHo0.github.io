---
layout:     post
title:      OJ压力测试
subtitle:   OJ系统测试
date:       2024-7-9
author:     Duu
header-img: img/post-bg-github-cup.jpg
catalog: true
tags:
    - 压力测试
---

### **压力测试**

#### 准备工作

下载jmeter

双击 jmeter文件夹下 /bin/jmeter.bat

> 前提需要Java环境

#### **创建测试步骤**

1. 右键test plan -> 新建线程组

![image-20240709005102503](https://cdn.jsdelivr.net/gh/0oHo0/Picture@main/img/202407090051570.png)

2. 右键线程组 -> 添加 -> 配置元件 -> HTTP请求默认值

添加 协议类型、服务器IP、端口号

![image-20240709005329230](https://cdn.jsdelivr.net/gh/0oHo0/Picture@main/img/202407090053278.png)

3. 右键线程组 -> 添加 -> 配置元件 -> HTTP信息头管理器

添加必要的头信息，内容类型、JWT认证Token、cookie等

![image-20240709005423740](https://cdn.jsdelivr.net/gh/0oHo0/Picture@main/img/202407090054784.png)

4. 右键线程组 -> 添加 -> 取样器 -> HTTP请求

![image-20240709005640790](https://cdn.jsdelivr.net/gh/0oHo0/Picture@main/img/202407090056833.png)

5. 线程组上右键 【添加】-->【断言】-->【响应断言】

![image-20240709005812474](https://cdn.jsdelivr.net/gh/0oHo0/Picture@main/img/202407090058512.png)

6. 线程组上右键 【添加】-->【监听器】-->【察看结果树】

![image-20240709005909203](https://cdn.jsdelivr.net/gh/0oHo0/Picture@main/img/202407090059238.png)

7. 线程组上右键 【添加】-->【监听器】-->【汇总报告】

![image-20240709005943515](https://cdn.jsdelivr.net/gh/0oHo0/Picture@main/img/202407090059547.png)

#### 参数解释

##### 性能指标 

**响应时间（Response Time: RT）** 

>  **响应时间指用户从客户端发起一个请求开始，到客户端接收到从服务器端返回的响 应结束，整个过程所耗费的时间。** 

**HPS（Hits Per Second）**

>  **每秒点击次数，单位是次/秒。** 

**TPS（Transaction per Second）**

>  **系统每秒处理交易数，单位是笔/秒。** 

**QPS（Query per Second）**

>  **系统每秒处理查询次数，单位是次/秒。 对于互联网业务中，如果某些业务有且仅有一个请求连接，那么 TPS=QPS=HPS，一 般情况下用 TPS 来衡量整个业务流程，用 QPS 来衡量接口查询次数，用 HPS 来表 示对服务器单击请求。** 

**无论 TPS、QPS、HPS,此指标是衡量系统处理能力非常重要的指标，越大越好，根据经验，一般情况下：** 

>  **金融行业：1000TPS~50000TPS，不包括互联网化的活动**  
>
>  **保险行业：100TPS~100000TPS，不包括互联网化的活动** 
>
>  **制造行业：10TPS~5000TPS** 
>
>  **互联网电子商务：10000TPS~1000000TPS** 
>
>  **互联网中型网站：1000TPS~50000TPS** 
>
>  **互联网小型网站：500TPS~10000TPS** 

**最大响应时间（Max Response Time）**

>  **指用户发出请求或者指令到系统做出反应（响应） 的最大时间。** 

**最少响应时间（Mininum ResponseTime）**

>  **指用户发出请求或者指令到系统做出反应（响 应）的最少时间。** 

 **90%响应时间（90% Response Time）**

>  **是指所有用户的响应时间进行排序，第 90%的响应时间。** 

**从外部看，****性能测试****主要关注如下三个指标** 

​    **吞吐量：每秒钟系统能够处理的请求数、任务数。** 

​    **响应时间：服务处理一个请求或一个任务的耗时。** 

​    **错误率：一批请求中结果出错的请求所占比例。** 

##### **线程组参数详解**

**线程数：虚拟用户数。一个虚拟用户占用一个进程或线程。设置多少虚拟用户数在这里 也就是设置多少个线程数。**

**Ramp-Up Period(in seconds)准备时长：设置的虚拟用户数需要多长时间全部启动。如果 线程数为 10，准备时长为 2，那么需要 2 秒钟启动 10 个线程，也就是每秒钟启动 5 个 线程。**

**循环次数：每个线程发送请求的次数。如果线程数为 10，循环次数为 100，那么每个线 程发送 100 次请求。总请求数为 10\*100=1000 。如果勾选了“永远”，那么所有线程会 一直发送请求，一到选择停止运行脚本。**

**Delay Thread creation until needed：直到需要时延迟线程的创建。**

**调度器：设置线程组启动的开始时间和结束时间(配置调度器时，需要勾选循环次数为 永远)**

**持续时间（秒）：测试持续时间，会覆盖结束时间**

**启动延迟（秒）：测试延迟启动时间，会覆盖启动时间**

**启动时间：测试启动时间，启动延迟会覆盖它。当启动时间已过，手动只需测试时当前 时间也会覆盖它。**

**结束时间：测试结束时间，持续时间会覆盖它。**

##### 结果树

- 取样器结果：返回值报200，表示执行接口调试成功

- 请求：发送的数据

- 响应数据：返回的数据

- Thread Name：线程组名称

- Sample Start: 启动开始时间

- Load time：加载时长

- Latency：等待时长

- Size in bytes：发送的数据总大小

- Headers size in bytes：发送数据的其余部分大小

- Sample Count：发送统计0

- Error Count：交互错误统计

- Response code：返回码

- Response message：返回信息

- Response headers：返回的头部信息
  

##### 聚合报告

- Label：HTTP Request name属性值。
- Samples：测试的过程中一共发出了多少个请求即总线程数，（如果模拟10个用户，每个用户迭代10次，这里
- 显示100），对应图形报表中的样本数目。
- Average：单个Request的平均响应时间，计算方法是总运行时间除以发送到服务器的总请求数，对应图形报表中的平均值。
- Median：50%用户的响应时间。
- 90%Line：90%用户的响应时间。
- Min：服务器响应的最短时间。
- Max：服务器响应的最长时间。
- Error%：本次测试中出错率，请求的数量/请求的总数。
- Throughput：吞吐量，默认情况下表示每秒完成的请求数。
- KB/Sec：每秒从服务器接收到的数据量，即每秒钟请求的字节数，时间单位均为ms。

#### 总结
一般情况下，当用户能够在2秒以内得到响应时，会感觉系统的响应很快；当用户在2-5秒之间 得到响应时，会感觉系统的响应速度还可以；当用户在5-10秒以内得到响应时，会感觉系统的 响应速度很慢，但是还可以接受；而当用户在超过10秒后仍然无法得到响应时，会感觉系统糟透了，或者认为系统已经失去响应，而选择离开这个Web站点，或者发起第二次请求。
